- name: cache the storage file
  ansible.builtin.copy:
      src: "/var/lib/libvirt/images/{{ fqdn }}.qcow2"
      remote_src: yes
      dest: "/var/lib/libvirt/images/{{ fqdn }}-base.qcow2"
      owner: qemu
      group: qemu
      mode: '0644'
  when: r_virt_install['failed'] == false

- name: create a directory for machine config
  ansible.builtin.file:
    path: ~/libvirt
    state: directory

- name: store machine config
  ansible.builtin.command:
    cmd: "virsh dumpxml {{ fqdn }}"
    chdir: ~/libvirt
    creates: "~/libvirt/{{ fqdn }}.xml"
